<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8">
  <title>그룹</title>
</head>
<body>
<!-- 그룹 등록 -->

<div>
  <form action="/api/groups/add" method="POST">
    그룸명 : <input name="name" type="text"><br>
    <button type="submit"> 생성</button>
  </form>
</div>
<!-- 초대 하기 -->

<!-- 초대 리스트 보기 -->
<!-- 초대 받기 -->
<!-- 그룹 리스트 보기-->
<div>
  <table id="groupList" style="border: 1px solid ">
  </table>
</div>


</body>
<script>
  var defaultUrl = "http://localhost:8081";

  post("api/groups/list")
  .then(data => groupsList(data))
  .catch(error => console.log(error))

  function groupsList(datas) {
    let out = "";
    datas.forEach(function (data, idx) {
      let groupId = data.groupsId;
      out += "" +
          "<tr onclick='location.href=`group/" + groupId + "`'>" +
          "<td>" + data.name + "</td>" +
          "</tr >";
    });
    document.getElementById("groupList").innerHTML = out;
  }

  async function get(url) {
    fetch(url)
    .then((response) => console.log("response : ", response))
    .catch((error) => console.log("error " + error));
  }

  async function post(path, headers = {}) {
    const url = `${defaultUrl}/${path}`;
    const options = {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        ...headers,
      },
    };
    const res = await fetch(url, options);
    const data = await res.json();
    if (res.ok) {
      return data;
    } else {
      throw Error(data);
    }
  }

  async function post(path, body, headers = {}) {
    const url = `${defaultUrl}/${path}`;
    const options = {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        ...headers,
      },
      body: JSON.stringify(body),
    };
    const res = await fetch(url, options);
    const data = await res.json();
    if (res.ok) {
      return data;
    } else {
      throw Error(data);
    }
  }

</script>
</html>